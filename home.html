<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/vendor/bootstrap.min.css">
    <title>Home</title>
    
</head>
<body>
    <h1>Galerix</h1>
    <div class="form-group"><input type="file" id="ArchivoCargado"></div>
    <div id="default"></div>

    <script>
        var numero = 0;
        var numerofinal;

        document.querySelector("#ArchivoCargado").addEventListener("change", function() {  //Cuando el usuario cambie el valor del input ejecutamos esta funcion
            const lector = new FileReader();

            lector.addEventListener("load", () => {
                localStorage.setItem(numero, lector.result);  //Guardamos la dataURL en el localstorage
                numero++;
                numerofinal = numero;
                loaded();
                localStorage.setItem("Numero", numerofinal);
            });

            lector.readAsDataURL(this.files[0]);   //Convertimos en dataURL la imagen cargada 
        });

        function loaded(){
            for (var i=0; i<numerofinal; i++){

                const recentImageDataUrl = localStorage.getItem(i);    

                var imagen = document.createElement("img");
                imagen.setAttribute("src", recentImageDataUrl);
                var divi = document.getElementById("default");
                document.body.insertBefore(imagen, divi);

            }
        }

        document.addEventListener("DOMContentLoaded", () => {    //Cuando la pagina cargue ejecutamos esta funcion 
            var numeron = localStorage.getItem("Numero");
            for (var i=0; i<numeron; i++){
                const recentImageDataUrl = localStorage.getItem(i);    //Cargamos la imagen guardada en el localstorage

                var imagen = document.createElement("img");
                imagen.setAttribute("src", recentImageDataUrl);
                var divi = document.getElementById("default");
                document.body.insertBefore(imagen, divi);
            }
        });
    </script>
</body>
</html>